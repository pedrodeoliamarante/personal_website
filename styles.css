
/* ============ Root & Globals ============ */
:root{
  --xp-blue:#0a64ad;
  --taskbar-top:#3a6ede;
  --taskbar-btm:#245edb;
  --window-bg:#ece9d8;
  --window-border:#bfcde0;

  /* layout vars */
  --tb-h:34px;
  --safe-b:env(safe-area-inset-bottom, 0px);
  --safe-t:env(safe-area-inset-top, 0px);
}

*{ box-sizing:border-box; }
html,body{ height:100%; margin:0; }
body{
  font-family:Tahoma, Verdana, sans-serif;
  background:url("assets/bliss_600dpi.jpg") no-repeat center center fixed;
  background-size:cover;
  color:#000;
  cursor:default;
}
.desktop{
  position:relative;
  height:calc(var(--vh, 1vh) * 100);
  overflow:hidden;
}

/* ============ Desktop Icons ============ */
/* Icon tile */
.desktop a.icon{
  position:absolute;
  width:110px;
  text-align:center;
  color:#fff;
  text-shadow:0 0 2px #000;
  text-decoration:none;
  user-select:none;
}

/* LARGE image size — override xp.css limits */
.desktop a.icon img {
  display: block;
  margin: 0 auto 6px;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

/* Classic .ico — smaller */
.desktop a.icon img[src$=".ico"] {
  width: 48px !important;
  height: 48px !important;
}

/* Non-.ico (png/jpg/svg/webp/gif) — bigger */
.desktop a.icon img[src$=".png"],
.desktop a.icon img[src$=".jpg"],
.desktop a.icon img[src$=".jpeg"],
.desktop a.icon img[src$=".webp"],
.desktop a.icon img[src$=".gif"],
.desktop a.icon img[src$=".svg"] {
  width: 72px !important;   /* bump to 96px */
  height: 72px !important;
  object-fit: contain;
}

/* Keep start-menu glyphs small */
.xp-start .start-item img{
  width:16px; height:16px; object-fit:contain;
  image-rendering:pixelated; image-rendering:crisp-edges;
}


/* ============ Windows (generic) ============ */
.window.app{
  position:absolute;
  background:var(--window-bg);
  border:1px solid var(--window-border);
  user-select:none;
}
.window.is-hidden{ display:none; }
.title-bar{ cursor:move; }
.title-bar-controls button{ cursor:default; }

/* ============ Taskbar ============ */
.taskbar{
  position:absolute; left:0; right:0; bottom:0;
  height:var(--tb-h);
  display:flex; align-items:center; gap:8px; padding:0;
  background:linear-gradient(to top, var(--taskbar-btm), var(--taskbar-top));
  border-top:2px solid #1a4aa5;
  box-shadow:0 -1px 0 #0a2a75 inset;
  z-index:10000;
}

/* Start button */
.start-button{
  display:block; width:104px; height:30px;
  background:url("assets/start_button.jpg") no-repeat left center / cover;
  border:none; border-radius:16px; text-indent:-9999px; overflow:hidden;
  box-shadow:0 1px 0 rgba(255,255,255,.35) inset, 0 1px 0 rgba(0,0,0,.25);
  cursor:pointer;
}
#start-toggle:checked ~ .taskbar .start-button{ transform:translateY(1px); filter:brightness(.93); }

/* Task buttons */
.task-buttons{ display:flex; gap:6px; margin-left:6px; overflow-x:auto; flex:1; }
.task-buttons .button{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 8px; height:26px; font-size:12px;
  background:linear-gradient(to top,#dfe8fd,#f4f6ff);
  border:1px solid #a3b2d4; border-radius:4px; box-shadow:inset 0 0 0 1px #fff;
  cursor:pointer; white-space:nowrap;
}
.task-buttons .button.active{ background:linear-gradient(to top,#bcd0ff,#e0e9ff); box-shadow:inset 1px 1px 0 #fff; }
.task-buttons .button:hover{ background:linear-gradient(to top,#cfe0ff,#eaf0ff); }
.task-buttons .button img{ width:16px; height:16px; image-rendering:pixelated; }

/* Tray */
.tray{ margin-left:auto; display:flex; align-items:center; gap:8px; color:#fff; }
.tray img{ width:16px; height:16px; image-rendering:pixelated; }
.clock{ font-size:12px; }

/* ============ Start Menu ============ */
.start-menu{
  position:fixed; left:0; bottom:var(--tb-h);
  display:none; width:520px; border-radius:6px; overflow:hidden; z-index:1000;
  background:#eaf3ff; border:1px solid #2b5daa;
  box-shadow:0 14px 30px rgba(0,0,0,.45), 0 0 0 1px rgba(0,0,0,.3);
}
#start-toggle:checked ~ .start-menu{ display:block; }

.xp-start{ display:flex; flex-direction:column; height:100%; }

/* Header */
.xp-start-header{
  background:linear-gradient(#1f4aa6,#123a8e);
  color:#fff; padding:10px 12px; font-weight:bold; font-size:14px; position:relative;
}
.user-badge{
  background:rgba(255,255,255,.15); display:inline-block; padding:3px 8px;
  border-radius:12px; border:1px solid rgba(0,0,0,.25);
}

/* Body */
.xp-start-body{
  display:grid; grid-template-columns:1fr 220px;
  background:linear-gradient(90deg, rgba(255,255,255,.6), rgba(255,255,255,0)) left top / 1px 100% no-repeat;
}
.xp-left{ padding:10px; background:linear-gradient(#f6fbff,#e0ecff); min-height:260px; }
.xp-right{ padding:10px; background:#f2f4f7; border-left:1px solid rgba(0,0,0,.08); }

/* Start menu items */
.start-item{
  display:flex; align-items:center; gap:8px; justify-content:flex-start;
  padding:6px 8px; margin-bottom:6px; width:100%; font-size:13px;
  background:transparent; border:none; cursor:pointer;
}
.start-item:hover{ background:#dbe5ff; border-radius:4px; }
.start-link{
  display:flex; align-items:center; gap:8px; padding:6px 4px; border-radius:4px;
  color:#000; text-decoration:none; font-size:13px;
}
.start-link:hover{ background:#e7edf9; }

/* Footer */
.xp-start-footer{
  display:flex; justify-content:flex-end; gap:8px; padding:8px;
  background:linear-gradient(#dff1df,#c2e2c2); border-top:1px solid rgba(0,0,0,.08);
}
.xp-start-footer .button{
  display:inline-flex; align-items:center; gap:6px; padding:4px 8px;
  border-radius:4px; border:1px solid #bfcde0; font-size:13px;
}
.xp-start-footer .button.ghost{ background:#fff; }
.xp-start-footer .button.danger{ background:#e55; color:#fff; border:1px solid #b33; }

/* ============ Work (Explorer & Mail UIs) ============ */
.work-body{ padding-top:6px; }
.work-toolbar{ display:flex; align-items:center; gap:6px; font-size:12px; color:#333; margin:2px 0 8px; }
.work-toolbar .sep{ opacity:.5; } .work-toolbar .crumb{ opacity:.85; } .work-toolbar .crumb.current{ font-weight:bold; opacity:1; }

.work-layout{ display:grid; grid-template-columns:260px 1fr; gap:8px; min-height:260px; }
.work-nav{ background:#fff; border:1px solid var(--window-border); border-radius:4px; padding:6px; overflow:auto; }
.work-tree{ margin:0; padding-left:0; }
.work-tree li{ list-style:none; margin:2px 0; }

.work-item{
  width:100%; display:flex; align-items:center; gap:8px; padding:6px;
  background:transparent; border:1px solid transparent; border-radius:4px; text-align:left; cursor:pointer; font-size:13px;
}
.work-item:hover{ background:#eaf0ff; border-color:#d0dcf5; }
.work-item.is-active{ background:#dce8ff; border-color:#a7baf0; }

.work-pane{ display:none; background:#fff; border:1px solid var(--window-border); border-radius:4px; padding:10px; }
.work-pane.is-visible{ display:block; }
.work-pane .meta{ margin:0 0 8px; font-size:12px; color:#444; }
.work-pane .bullets{ margin:0 0 8px 18px; } .work-pane .bullets li{ margin-bottom:4px; }
.work-pane .stack{ font-size:12px; color:#222; }

/* Mail layout inside Work */
.mail-toolbar{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.mail-title{ font-weight:bold; }
.mail-actions .btn{ padding:4px 8px; border:1px solid #bfcde0; border-radius:4px; background:#fff; font-size:12px; }
.mail-layout{ display:grid; grid-template-columns:320px 1fr; gap:8px; min-height:260px; }
.mail-list{ background:#fff; border:1px solid var(--window-border); border-radius:4px; overflow:auto; }
.mail-pane{ background:#fff; border:1px solid var(--window-border); border-radius:4px; padding:10px; overflow:auto; }
.mail-item{ padding:8px; border-bottom:1px solid #e6ecf6; cursor:pointer; outline:none; }
.mail-item:last-child{ border-bottom:none; }
.mail-item.is-selected{ background:#eaf0ff; }
.mail-item.is-unread .mail-subject{ font-weight:bold; }
.mail-item-top{ display:flex; justify-content:space-between; font-size:12px; color:#444; }
.mail-subject{ margin:2px 0; } .mail-snippet{ font-size:12px; color:#555; }
.mail-tags{ margin-top:4px; display:flex; gap:4px; }
.tag{ font-size:11px; padding:2px 6px; border:1px solid #bfcde0; border-radius:10px; background:#f7faff; }
.mail-header{ border-bottom:1px solid #e6ecf6; margin-bottom:8px; padding-bottom:6px; }
.mail-subject-lg{ font-size:16px; font-weight:bold; margin-bottom:4px; }
.mail-meta{ font-size:12px; color:#444; display:flex; gap:16px; flex-wrap:wrap; }
.mail-bullets{ margin:8px 0 0 18px; } .mail-bullets li{ margin-bottom:4px; }

/* ============ MSN Bio ============ */
.msn-body{ padding:6px; background:linear-gradient(#eef4fd,#ffffff); }
.msn-toolbar{
  display:flex; justify-content:space-between; align-items:center;
  background:linear-gradient(#f8fbff,#e7effd); border:1px solid #bfcde0; border-radius:6px; padding:6px 8px; margin-bottom:6px;
}
.msn-toolbar-group{ display:flex; gap:6px; }
.msn-tbtn{ font-size:12px; padding:4px 8px; border:1px solid #bfcde0; border-radius:4px; background:#fff; cursor:pointer; }
.msn-tbtn:hover{ background:#f5f9ff; }
.msn-presence{ display:flex; align-items:center; gap:6px; }
.msn-status{ font-size:12px; }
.dot{ width:10px; height:10px; border-radius:50%; display:inline-block; border:1px solid #777; }
.dot.online{ background:#2ecc71; } .dot.away{ background:#f1c40f; } .dot.busy{ background:#e74c3c; } .dot.offline{ background:#7f8c8d; }

.msn-to{ display:flex; align-items:center; gap:6px; border:1px solid #bfcde0; border-radius:6px; background:#fff; padding:6px 8px; margin-bottom:6px; }
.msn-to label{ font-size:12px; color:#333; }
.msn-to-input{ flex:1; border:none; outline:none; font-size:12px; padding:2px 4px; background:transparent; }

.msn-layout{ display:grid; grid-template-columns:1fr 160px; gap:8px; min-height:260px; }
.msn-chat{ background:#fff; border:1px solid #bfcde0; border-radius:6px; padding:8px; overflow:auto; max-height:44vh; }
.msn-avatars{ display:flex; flex-direction:column; gap:8px; }
.msn-avatar{ background:#fff; border:1px solid #bfcde0; border-radius:6px; padding:8px; display:flex; justify-content:center; align-items:center; }
.msn-avatar img{ width:120px; height:120px; object-fit:cover; border-radius:8px; image-rendering:pixelated; }

.msn-compose{ display:grid; grid-template-columns:1fr 100px; gap:8px; align-items:stretch; margin-top:6px; }
.msn-formatbar{ grid-column:1/span 1; display:flex; gap:6px; margin-bottom:4px; }
.msn-input{
  grid-column:1/span 1; height:84px; width:100%; resize:vertical;
  border:1px solid #bfcde0; border-radius:6px; padding:8px; font-size:13px; background:#fdfefe;
}
.msn-sendcol{ display:flex; flex-direction:column; gap:6px; justify-content:flex-end; }
.msn-send,.msn-nudge{ padding:6px 10px; border:1px solid #bfcde0; border-radius:6px; background:#fff; cursor:pointer; font-size:12px; }
.msn-send[disabled]{ opacity:.6; cursor:not-allowed; }

.msn-footer{ display:flex; align-items:center; justify-content:space-between; margin-top:6px; font-size:11px; color:#555; }
.msn-ctrl{ padding:4px 8px; border:1px solid #bfcde0; border-radius:6px; background:#fff; font-size:12px; cursor:pointer; }
.msn-ctrl:hover{ background:#f5f9ff; }

/* Chat bubbles */
.msn-line{ display:flex; gap:8px; margin:6px 0; align-items:flex-start; }
.msn-line .avatar{ width:28px; height:28px; border-radius:4px; background:#dfe8ff; flex:none; overflow:hidden; display:flex; align-items:center; justify-content:center; }
.msn-line .avatar img{ width:100%; height:100%; object-fit:cover; }
.msn-msg{ max-width:82%; padding:6px 8px; border-radius:8px; border:1px solid #dfe6f5; background:#f7faff; font-size:13px; }
.msn-msg.me{ background:#eef6ff; border-color:#ccdafa; }
.msn-meta{ font-size:10px; color:#777; margin-top:2px; }

/* Nudge */
@keyframes msn-nudge{
  10%,90%{ transform:translate(-2px,0); }
  20%,80%{ transform:translate(4px,0); }
  30%,50%,70%{ transform:translate(-6px,0); }
  40%,60%{ transform:translate(6px,0); }
}
.msn-win.is-nudged{ animation:msn-nudge .35s linear 1; }

/* ============ Contact App ============ */
.contact-card{
  display:grid; gap:10px; background:#fff; border:1px solid var(--window-border);
  border-radius:6px; padding:10px; position:relative;
}
.contact-head{ display:flex; gap:10px; align-items:center; border-bottom:1px solid #e6ecf6; padding-bottom:8px; margin-bottom:4px; }
.contact-avatar{
  width:72px; height:72px; border-radius:8px; object-fit:cover; image-rendering:pixelated; border:1px solid #cfd9ea;
}
.contact-meta{ display:grid; gap:2px; }
.contact-name{ font-size:18px; font-weight:700; }
.contact-title,.contact-company{ font-size:13px; color:#444; }
.contact-grid{ display:grid; gap:6px; }
.contact-grid .row{
  display:grid; grid-template-columns:120px 1fr auto; align-items:center; gap:8px; font-size:13px;
}
.contact-grid .row > span:first-child{ color:#333; opacity:.85; }
.contact-grid .links a{ margin-right:10px; }
.contact-actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:6px; }
.contact-actions .btn,.contact-grid .mini{ padding:4px 10px; border:1px solid #bfcde0; border-radius:6px; background:#fff; font-size:12px; cursor:pointer; }
.contact-actions .btn:hover,.contact-grid .mini:hover{ background:#f5f9ff; }
.contact-toast{
  position:absolute; right:10px; bottom:10px; background:rgba(20,20,20,.9); color:#fff;
  padding:6px 10px; border-radius:6px; font-size:12px; opacity:0; transform:translateY(6px);
  pointer-events:none; transition:.2s ease;
}
.contact-toast.show{ opacity:1; transform:translateY(0); }
@media (max-width:600px){
  .contact-grid .row{ grid-template-columns:100px 1fr auto; }
  .contact-avatar{ width:64px; height:64px; }
}

/* ============ Context Menu / Shutdown ============ */
.wm-context{
  background:#f9f9f9; border:1px solid #aaa; border-radius:4px;
  box-shadow:0 2px 6px rgba(0,0,0,.3); font-size:13px; display:flex; flex-direction:column; min-width:140px;
}
.wm-context button{ padding:6px 10px; border:none; background:transparent; text-align:left; cursor:pointer; }
.wm-context button:hover{ background:#dce8ff; }
.wm-context button.danger{ color:#b00; }
.wm-context hr{ border:none; border-top:1px solid #ccc; margin:4px 0; }

.wm-shutdown{
  position:fixed; inset:0; background:#000; color:#fff; display:flex; align-items:center; justify-content:center;
  font-family:Tahoma, sans-serif; font-size:20px; z-index:999999;
}

/* ============ Responsive ============ */
/* Tablet & big phones (<=900px) */
@media (max-width:900px){
  :root{ --tb-h:42px; }

  /* Icons flow in a grid */
  .desktop{
    display:grid;
    grid-template-columns:repeat(4, minmax(72px, 1fr));
    grid-auto-rows:max-content;
    gap:10px 12px;
    padding:12px 12px calc(var(--tb-h) + 12px + var(--safe-b));
  }
  .desktop > a.icon{ position:static !important; width:100%; }

  /* Windows fit but remain draggable */
  .window.app{
    top:calc(var(--safe-t) + 8px); left:8px;
    width:calc(100vw - 16px);
    height:auto;
    max-height:calc(100dvh - var(--tb-h) - 24px - var(--safe-b) - var(--safe-t));
    overflow:hidden; border-radius:8px;
  }
  .window .window-body{ height:100%; overflow:auto; }
  .title-bar{ cursor:default; }

  /* Taskbar & start menu tweaks */
  .task-buttons .button{ height:32px; font-size:13px; padding:4px 10px; }
  .start-button{ height:34px; }
  .tray img{ width:18px; height:18px; }
  .clock{ font-size:13px; }

  .start-menu{
    width:96vw; left:2vw; right:2vw;
    border-radius:10px; max-height:min(70vh, 520px); overflow:hidden;
  }
  .xp-start-body{ grid-template-columns:1fr; }
  .xp-right{ border-left:0; border-top:1px solid rgba(0,0,0,.08); }

  /* Work & Mail stack */
  .mail-layout{ grid-template-columns:1fr; }
  .mail-list{ max-height:180px; }
  .mail-pane{ min-height:220px; }
  .work-layout{ grid-template-columns:1fr; }
  .work-nav{ max-height:200px; }
}

/* Phones portrait (<=600px) */
@media (max-width:600px){
  :root{ --tb-h:48px; }

  .desktop{
    grid-template-columns:repeat(3, minmax(68px, 1fr));
    gap:10px 10px;
    padding:10px 8px calc(var(--tb-h) + 10px + var(--safe-b));
  }
  .desktop a.icon img{ width:64px !important; height:64px !important; } /* slightly smaller on phones */
  .desktop a.icon span{ font-size:11px; }

  .window.app{
    top:calc(var(--safe-t) + 6px); left:6px;
    width:calc(100vw - 12px);
    border-radius:10px;
  }

  /* MSN tweaks */
  .msn-layout{
    display:grid;
    grid-template-columns:1fr;
    grid-template-areas:"chat" "avatars";
    gap:6px; min-height:auto;
  }
  .msn-chat{ max-height:40vh; }
  .msn-avatars{ flex-direction:row; gap:6px; }
  .msn-avatar img{ width:84px; height:84px; }
  .msn-compose{ grid-template-columns:1fr; }
  .msn-sendcol{ flex-direction:row; }
  .msn-tbtn,.msn-ctrl,.msn-send,.msn-nudge{ padding:8px 10px; font-size:13px; }

  .mail-subject-lg{ font-size:18px; }
  .mail-item{ padding:10px; }
}

/* Ultra-narrow (<=380px) — two columns of icons */
@media (max-width:380px){
  .desktop{ grid-template-columns:repeat(2, minmax(68px, 1fr)); }
}

/* Accessibility: respect reduced motion */
@media (prefers-reduced-motion:reduce){
  .msn-win.is-nudged{ animation:none !important; }
}
